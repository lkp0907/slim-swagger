<?php/*Author : GiPyeong.LeeLicense : MITDate : 2016-10-06*/// 1. Load Files. ( which  @swag tag included)$regex = '/(?s)(?<=\@swag)(.*?)(?=\/\@)/';$handle = fopen('/home/ubuntu/index.php', 'r');$content = stream_get_contents($handle);fclose($handle);preg_match_all($regex, $content, $matches,PREG_SET_ORDER);$length = count($matches);$json_strings = [];for($i=0;$i<$length;$i++){	$json_strings[] = '{'.str_replace("\\\"","\"",str_replace(array("\t", "\n"), "",$matches[$i][0])).'}';}//echo json_encode($json_strings);//echo json_encode($json_strings);$length = count($json_strings);$documents = [];for($i=0;$i<$length;$i++){	$data = $json_strings[$i];	preg_match_all("|(?<hangul>[가-힣]+)|su", $data, $korean);	for($j=0;$j<count($korean['hangul']);$j++){		$data = str_replace($korean['hangul'][$j],urlencode($korean['hangul'][$j]),$data);	}	$data = json_decode($data,true);	$documents = array_merge($documents,$data);}///////////// NOW LETS GET SLIM FRAMEWORKS ROUTE ///$regex = '/\$app->get\(\'(.*?)\'\,/i'; //GET$regex = '/\$app->put\(\'(.*?)\'\,/i'; //putpreg_match_all($regex, $content, $matches,PREG_SET_ORDER);$length = count($matches);$pathes = [];for($i=0;$i<$length;$i++){	$route = $matches[$i][1];	$path = [];	$params = [];	if(trim($route) != ""){		$route = makeSwaggerPath(explode('/',$route),$params);			$route= implode('/',$route);	}	$info = [];	$info['tags'] = [''];	$info['summary'] = '';	$info['description'] = '';	$info['consumes'] = ['application/json','application/xml'];	$info['produces'] = ['application/json','application/xml'];		if(count($params)>0){		$info['parameters'] = [];		for($j=0;$j<count($params);$j++){			$param = [];			$param['name'] = $params[$j];			$param['in'] = 'path';			$param['description'] = '';			$param['required'] = true;			$param['type'] = 'string';			//$param['format'] = '';			$info['parameters'][] = $param;		}	}		$path['get'] = $info;	$pathes[$route] = $path;	}function makeSwaggerPath($path = [],&$params){	for($i=0;$i<count($path);$i++){		$part = $path[$i];		if (strpos($part, ':') !== false) {			$part = str_replace(':','',$part);			$part = str_replace('+','',$part);			$params[] = $part;			$path[$i] = '{'.$part.'}';					}	}	return $path;}$documents = array_merge($documents,['paths'=>$pathes]);///// Write JSON$handler = fopen('/home/ubuntu/swaggers/documents.json','w');fwrite($handler,urldecode(str_replace("\\/","/",json_encode($documents,JSON_PRETTY_PRINT))));fclose($handler);?>